# static과 메모리의 관계

자바의 메모리 구조는 다음과 같이 여러 영역으로 나눌 수 있습니다:

1. **메소드 영역(Method Area 또는 Class Area)**:
    - JVM이 시작될 때 생성되는 영역으로, 클래스 파일을 읽고 클래스에 대한 정보를 저장합니다.
    - 클래스 정보, 정적 변수, 상수, 메소드 코드 등이 저장됩니다.
    - 모든 스레드가 공유하는 영역입니다.
    - static-zone과 non static-zone 으로 나뉘어짐.
2. **힙(Heap)**:
    - 동적으로 할당되는 객체와 배열이 저장되는 영역입니다.
    - Garbage Collector에 의해 관리되며, 더 이상 사용되지 않는 객체들을 자동으로 정리합니다.
    - 힙은 Young Generation, Old Generation 및 PermGen(Java 7 이전) 또는 Metaspace(Java 8 이후)로 나뉩니다.
        
        [Young gen v. Old gen of heap memory](static%E1%84%80%E1%85%AA%20%E1%84%86%E1%85%A6%E1%84%86%E1%85%A9%E1%84%85%E1%85%B5%E1%84%8B%E1%85%B4%20%E1%84%80%E1%85%AA%E1%86%AB%E1%84%80%E1%85%A8%205fca320f1c5e46b0a5299c963c73fe7d/Young%20gen%20v%20Old%20gen%20of%20heap%20memory%209ebfea2c8f8d4657a256f2073fbed82f.md)
        
3. **스택(Stack)**:
    - 각 스레드마다 별도로 생성되는 영역으로, 메소드 호출 및 지역 변수가 저장됩니다.
    - 메소드가 호출될 때마다 해당 메소드에 대한 호출 정보와 지역 변수가 스택 프레임에 저장됩니다.
    - 스택 프레임은 메소드 호출이 끝나면 pop되어 제거됩니다.
4. **PC 레지스터(Program Counter Register)**:
    - 현재 실행 중인 스레드의 명령어 주소를 저장하는 영역입니다.
    - 스레드마다 별도로 생성되며, 스레드가 실행될 때마다 PC 레지스터가 생성됩니다.
5. **네이티브 메소드 스택(Native Method Stack)**:
    - 자바 외부에서 호출된 네이티브 메소드의 정보를 저장하는 영역입니다.
    - 네이티브 메소드는 자바 외부의 네이티브 코드로 작성된 메소드를 의미합니다.

### main 클래스가 실행되는 방식

1. JVM이 실행할 클래스를 찾는다. 찾았다면?
2. static 키워드가 붙어있는 멤버들을 정해진 메모리(static-zone) 위치에 한번 자동으로 로딩 한다. 즉, 클래스를 사용하는 시점에서 자동으로 static-zone에 로딩된다.
    - static 멤버들은 클래스를 사용하는 시점에서 딱 한번 메모리에 로딩 된다는 점이 중요하다.
    - 여기서는 main() 메서드가 static이기 때문에 메모리에 자동으로 로딩 한다.
    - static 멤버들은 new를 통한 객체생성 없이도 자동으로 메모리에 로딩 된다는 것이다.
3. JVM이 static-zone에서 main() 메서드를 호출한다.
4. 호출된 메서드를 Call Stack Frame Area(Stack Area)에 push(기계어 코드를 넣고) 한 뒤 동작을 시작한다.

**PC: program counter (프로그램 제어권, 가르키는 곳이 실행하고 있는 곳)

![Untitled](static%E1%84%80%E1%85%AA%20%E1%84%86%E1%85%A6%E1%84%86%E1%85%A9%E1%84%85%E1%85%B5%E1%84%8B%E1%85%B4%20%E1%84%80%E1%85%AA%E1%86%AB%E1%84%80%E1%85%A8%205fca320f1c5e46b0a5299c963c73fe7d/Untitled.png)

Method Area는 JVM의 메모리 영역 중 하나로, 클래스 정보, 정적 변수, 상수 및 메소드 코드를 저장하는 곳이다. 이 영역에는 모든 클래스의 바이트코드가 로드되고 파싱된 후 저장된다. 클래스의 이름, 메소드 및 변수의 이름, 접근 제어자 등의 정보뿐만 아니라, 클래스에 정의된 정적 변수와 상수들도 여기에 할당된다. 이 영역은 Heap영역과는 다르며, 모든 스레드가 공유하는 영역이다. 공간의 크기는 JVM에 따라 동적으로 조정될 수 있다.

![Untitled](static%E1%84%80%E1%85%AA%20%E1%84%86%E1%85%A6%E1%84%86%E1%85%A9%E1%84%85%E1%85%B5%E1%84%8B%E1%85%B4%20%E1%84%80%E1%85%AA%E1%86%AB%E1%84%80%E1%85%A8%205fca320f1c5e46b0a5299c963c73fe7d/Untitled%201.png)

** 클래스 메서드: static 메서드, 인스턴스 메서드: static 없는 메서드